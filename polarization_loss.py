# polarization_loss.py

POLARIZATION_LOSS_DB = {
    "горизонт": {
        "горизонт": 0,
        "вертик": 16,
        "x-поляр": 3,
        "круг. левая": 3,
        "круг. правая": 3
    },
    "вертик": {
        "горизонт": 16,
        "вертик": 0,
        "x-поляр": 3,
        "круг. левая": 3,
        "круг. правая": 3
    },
    "x-поляр": {
        "горизонт": 3,
        "вертик": 3,
        "x-поляр": 0,
        "круг. левая": 3,
        "круг. правая": 3
    },
    "круг. левая": {
        "горизонт": 3,
        "вертик": 3,
        "x-поляр": 3,
        "круг. левая": 0,
        "круг. правая": 25
    },
    "круг. правая": {
        "горизонт": 3,
        "вертик": 3,
        "x-поляр": 3,
        "круг. левая": 25,
        "круг. правая": 0
    }
}

def get_polarization_loss(tx_pol: str, rx_pol: str) -> float:
    """
    Возвращает потери из-за несовпадения поляризации в дБ.
    Если неизвестная поляризация — возвращает 0 и предупреждает.
    """
    tx_pol = tx_pol.strip().lower()
    rx_pol = rx_pol.strip().lower()
    tx_entry = POLARIZATION_LOSS_DB.get(tx_pol)
    if tx_entry is None:
        print(f"⚠️ Неизвестная поляризация передатчика: '{tx_pol}'")
        return 0
    loss = tx_entry.get(rx_pol)
    if loss is None:
        print(f"⚠️ Неизвестная поляризация приёмника: '{rx_pol}'")
        return 0
    return loss
